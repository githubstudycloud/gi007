# åå‘ä»£ç†ä¸ŽæœåŠ¡å¯¼èˆªé…ç½®

## ä¸€ã€æ•´ä½“æž¶æž„

ç”±äºŽåªæœ‰ cpolar å†…ç½‘ç©¿é€ä¸”ç«¯å£æœ‰é™ï¼Œé‡‡ç”¨ä»¥ä¸‹æž¶æž„ï¼š

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                  äº’è”ç½‘                      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚     cpolar      â”‚
                              â”‚   (ä»…ç©¿é€443)   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Nginx Proxy Manager (Webé…ç½®)                         â”‚
â”‚                         https://xxx.cpolar.cn                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   /                    -> Homepage (å¯¼èˆªé¡µ)                               â”‚
â”‚   /status              -> Uptime Kuma (æœåŠ¡ç›‘æŽ§)                          â”‚
â”‚   /portainer           -> Portainer (å®¹å™¨ç®¡ç†)                            â”‚
â”‚                                                                          â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æžç©ºé—´æœåŠ¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚   /gitlab              -> GitLab                                         â”‚
â”‚   /jenkins             -> Jenkins                                        â”‚
â”‚   /code                -> code-server                                    â”‚
â”‚   /jupyter             -> Jupyter                                        â”‚
â”‚   /nacos               -> Nacos                                          â”‚
â”‚   /minio               -> MinIO                                          â”‚
â”‚   /grafana             -> Grafana                                        â”‚
â”‚                                                                          â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç»¿è”æœåŠ¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚   /media               -> Jellyfin                                       â”‚
â”‚   /music               -> Navidrome                                      â”‚
â”‚   /photos              -> Immich                                         â”‚
â”‚   /cloud               -> Nextcloud                                      â”‚
â”‚   /vault               -> Vaultwarden                                    â”‚
â”‚   /files               -> Alist                                          â”‚
â”‚   /home                -> Home Assistant                                 â”‚
â”‚   /download            -> qBittorrent                                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€Nginx Proxy Manager é…ç½®

### 2.1 Docker Compose

```yaml
# docker-compose.npm.yml
version: '3.8'

services:
  npm:
    image: jc21/nginx-proxy-manager:latest
    container_name: nginx-proxy-manager
    restart: always
    ports:
      - "80:80"      # HTTP
      - "443:443"    # HTTPS (cpolarç©¿é€è¿™ä¸ª)
      - "81:81"      # ç®¡ç†ç•Œé¢
    volumes:
      - ./npm/data:/data
      - ./npm/letsencrypt:/etc/letsencrypt
      - ./npm/custom:/data/nginx/custom  # è‡ªå®šä¹‰é…ç½®
    environment:
      - TZ=Asia/Shanghai
    networks:
      - proxy-net

networks:
  proxy-net:
    driver: bridge
```

### 2.2 é¦–æ¬¡è®¿é—®

```
åœ°å€: http://NAS-IP:81
é»˜è®¤è´¦å·: admin@example.com
é»˜è®¤å¯†ç : changeme
```

### 2.3 å­è·¯å¾„ä»£ç†é…ç½®

NPM é»˜è®¤ä¸æ”¯æŒå­è·¯å¾„ä»£ç†ï¼Œéœ€è¦æ·»åŠ è‡ªå®šä¹‰é…ç½®ã€‚

**æ–¹æ³•1: ä½¿ç”¨ Advanced é…ç½®**

åœ¨ NPM çš„ Proxy Host é«˜çº§è®¾ç½®ä¸­æ·»åŠ ï¼š

```nginx
# GitLab å­è·¯å¾„ä»£ç†ç¤ºä¾‹
location /gitlab {
    proxy_pass http://192.168.1.100:80;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    # WebSocket æ”¯æŒ
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
}
```

**æ–¹æ³•2: è‡ªå®šä¹‰ Nginx é…ç½®æ–‡ä»¶**

åˆ›å»º `./npm/custom/server_proxy.conf`:

```nginx
# ============ å¯¼èˆªä¸Žç›‘æŽ§ ============

# é¦–é¡µ -> Homepage
location = / {
    return 302 /homepage/;
}

location /homepage/ {
    proxy_pass http://homepage:3000/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}

# æœåŠ¡çŠ¶æ€ç›‘æŽ§
location /status/ {
    proxy_pass http://uptime-kuma:3001/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
}

# Portainer
location /portainer/ {
    proxy_pass http://portainer:9000/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}

# ============ æžç©ºé—´æœåŠ¡ ============

# GitLab (éœ€è¦é…ç½®external_urlå¸¦å­è·¯å¾„)
location /gitlab/ {
    proxy_pass http://192.168.1.100:80/gitlab/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_read_timeout 300;
    proxy_connect_timeout 300;
    client_max_body_size 500m;
}

# Jenkins
location /jenkins/ {
    proxy_pass http://192.168.1.100:8080/jenkins/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_http_version 1.1;
    proxy_request_buffering off;
}

# code-server
location /code/ {
    proxy_pass http://192.168.1.100:8443/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection upgrade;
    proxy_set_header Accept-Encoding gzip;
}

# Jupyter
location /jupyter/ {
    proxy_pass http://192.168.1.100:8888/jupyter/;
    proxy_set_header Host $host;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_read_timeout 86400;
}

# Nacos
location /nacos/ {
    proxy_pass http://192.168.1.100:8848/nacos/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}

# MinIO Console
location /minio/ {
    proxy_pass http://192.168.1.100:9001/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
}

# Grafana
location /grafana/ {
    proxy_pass http://192.168.1.100:3000/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}

# ============ ç»¿è”æœåŠ¡ ============

# Jellyfin
location /media/ {
    proxy_pass http://192.168.1.101:8096/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_buffering off;
}

# Navidrome
location /music/ {
    proxy_pass http://192.168.1.101:4533/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}

# Immich
location /photos/ {
    proxy_pass http://192.168.1.101:2283/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    client_max_body_size 50000m;
}

# Nextcloud
location /cloud/ {
    proxy_pass http://192.168.1.101:8083/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    client_max_body_size 10G;
    proxy_connect_timeout 3600;
    proxy_send_timeout 3600;
    proxy_read_timeout 3600;
}

# Vaultwarden
location /vault/ {
    proxy_pass http://192.168.1.101:8084/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
}

# Alist
location /files/ {
    proxy_pass http://192.168.1.101:5244/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}

# Home Assistant
location /home/ {
    proxy_pass http://192.168.1.101:8123/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
}

# qBittorrent
location /download/ {
    proxy_pass http://192.168.1.101:8080/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-Host $host;
    proxy_cookie_path / "/download/";
}
```

---

## ä¸‰ã€Homepage å¯¼èˆªé¡µ

### 3.1 Docker Compose

```yaml
# docker-compose.homepage.yml
version: '3.8'

services:
  homepage:
    image: ghcr.io/gethomepage/homepage:latest
    container_name: homepage
    restart: always
    ports:
      - "3000:3000"
    volumes:
      - ./homepage/config:/app/config
      - /var/run/docker.sock:/var/run/docker.sock:ro  # Dockeré›†æˆ
    environment:
      - TZ=Asia/Shanghai
    networks:
      - proxy-net

networks:
  proxy-net:
    external: true
```

### 3.2 é…ç½®æ–‡ä»¶

**settings.yaml** - åŸºç¡€è®¾ç½®
```yaml
# ./homepage/config/settings.yaml
title: æˆ‘çš„NASæœåŠ¡
favicon: https://example.com/favicon.ico
theme: dark
color: slate
headerStyle: clean
layout:
  å¼€å‘æœåŠ¡:
    style: row
    columns: 4
  åª’ä½“å¨±ä¹:
    style: row
    columns: 4
  å®¶åº­æœåŠ¡:
    style: row
    columns: 4
  ç³»ç»Ÿç®¡ç†:
    style: row
    columns: 3
```

**services.yaml** - æœåŠ¡é…ç½®
```yaml
# ./homepage/config/services.yaml
- å¼€å‘æœåŠ¡:
    - GitLab:
        icon: gitlab.svg
        href: /gitlab/
        description: ä»£ç æ‰˜ç®¡
        server: zspace
        container: gitlab
        widget:
          type: gitlab
          url: http://192.168.1.100:80
          key: your-gitlab-api-key

    - Jenkins:
        icon: jenkins.svg
        href: /jenkins/
        description: CI/CD
        server: zspace
        container: jenkins

    - Code Server:
        icon: vscode.svg
        href: /code/
        description: åœ¨çº¿IDE
        server: zspace
        container: code-server

    - Jupyter:
        icon: jupyter.svg
        href: /jupyter/
        description: æ•°æ®åˆ†æž
        server: zspace
        container: jupyter

    - Nacos:
        icon: nacos.svg
        href: /nacos/
        description: æœåŠ¡æ³¨å†Œ

    - MinIO:
        icon: minio.svg
        href: /minio/
        description: å¯¹è±¡å­˜å‚¨

- åª’ä½“å¨±ä¹:
    - Jellyfin:
        icon: jellyfin.svg
        href: /media/
        description: è§†é¢‘åª’ä½“
        server: ugreen
        container: jellyfin
        widget:
          type: jellyfin
          url: http://192.168.1.101:8096
          key: your-jellyfin-api-key

    - Navidrome:
        icon: navidrome.svg
        href: /music/
        description: éŸ³ä¹æµåª’ä½“
        server: ugreen
        container: navidrome
        widget:
          type: navidrome
          url: http://192.168.1.101:4533
          user: admin
          token: your-token
          salt: your-salt

    - Immich:
        icon: immich.svg
        href: /photos/
        description: ç…§ç‰‡ç®¡ç†
        server: ugreen
        container: immich-server

    - qBittorrent:
        icon: qbittorrent.svg
        href: /download/
        description: ä¸‹è½½å·¥å…·
        server: ugreen
        container: qbittorrent
        widget:
          type: qbittorrent
          url: http://192.168.1.101:8080
          username: admin
          password: adminadmin

- å®¶åº­æœåŠ¡:
    - Home Assistant:
        icon: home-assistant.svg
        href: /home/
        description: æ™ºèƒ½å®¶å±…
        widget:
          type: homeassistant
          url: http://192.168.1.101:8123
          key: your-ha-token

    - Nextcloud:
        icon: nextcloud.svg
        href: /cloud/
        description: å®¶åº­äº‘ç›˜
        server: ugreen
        container: nextcloud

    - Vaultwarden:
        icon: bitwarden.svg
        href: /vault/
        description: å¯†ç ç®¡ç†
        server: ugreen
        container: vaultwarden

    - Alist:
        icon: alist.svg
        href: /files/
        description: ç½‘ç›˜èšåˆ
        server: ugreen
        container: alist

- ç³»ç»Ÿç®¡ç†:
    - Portainer:
        icon: portainer.svg
        href: /portainer/
        description: å®¹å™¨ç®¡ç†
        widget:
          type: portainer
          url: http://192.168.1.101:9000
          env: 1
          key: your-portainer-api-key

    - Uptime Kuma:
        icon: uptime-kuma.svg
        href: /status/
        description: æœåŠ¡ç›‘æŽ§
        widget:
          type: uptimekuma
          url: http://uptime-kuma:3001
          slug: homepage

    - Grafana:
        icon: grafana.svg
        href: /grafana/
        description: ç›‘æŽ§é¢æ¿
        server: zspace
        container: grafana
```

**docker.yaml** - DockeræœåŠ¡å™¨é…ç½®
```yaml
# ./homepage/config/docker.yaml
zspace:
  host: 192.168.1.100
  port: 2375
  # æˆ–ä½¿ç”¨socket
  # socket: /var/run/docker.sock

ugreen:
  host: 192.168.1.101
  port: 2375
```

**widgets.yaml** - é¦–é¡µå°éƒ¨ä»¶
```yaml
# ./homepage/config/widgets.yaml
- resources:
    cpu: true
    memory: true
    disk: /

- search:
    provider: google
    target: _blank

- datetime:
    text_size: xl
    format:
      dateStyle: long
      timeStyle: short
      hour12: false
```

### 3.3 Homepage æ•ˆæžœé¢„è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ  æˆ‘çš„NASæœåŠ¡                                       2024-01-15 14:30  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ“Š èµ„æºç›‘æŽ§                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ CPU: 23%     â”‚ â”‚ å†…å­˜: 45%    â”‚ â”‚ ç£ç›˜: 62%    â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš™ï¸ å¼€å‘æœåŠ¡                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ GitLab  â”‚ â”‚ Jenkins â”‚ â”‚ VS Code â”‚ â”‚ Jupyter â”‚ â”‚ Nacos   â”‚          â”‚
â”‚  â”‚ ðŸŸ¢ è¿è¡Œ â”‚ â”‚ ðŸŸ¢ è¿è¡Œ â”‚ â”‚ ðŸŸ¢ è¿è¡Œ â”‚ â”‚ ðŸŸ¢ è¿è¡Œ â”‚ â”‚ ðŸŸ¢ è¿è¡Œ â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸŽ¬ åª’ä½“å¨±ä¹                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ Jellyfinâ”‚ â”‚ Navidromeâ”‚ â”‚ Immich â”‚ â”‚ qBit    â”‚                       â”‚
â”‚  â”‚ ðŸŽ¬ 1234 â”‚ â”‚ ðŸŽµ 5678 â”‚ â”‚ ðŸ“· 9999â”‚ â”‚ â¬‡ï¸ 2ä¸ª  â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ  å®¶åº­æœåŠ¡                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ HA      â”‚ â”‚Nextcloudâ”‚ â”‚ Vault   â”‚ â”‚ Alist   â”‚                       â”‚
â”‚  â”‚ ðŸ’¡ 12ä¸ª â”‚ â”‚ ðŸ“ è¿è¡Œ â”‚ â”‚ ðŸ” è¿è¡Œ â”‚ â”‚ â˜ï¸ è¿è¡Œ â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ”§ ç³»ç»Ÿç®¡ç†                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚  â”‚Portainerâ”‚ â”‚ Uptime  â”‚ â”‚ Grafana â”‚                                   â”‚
â”‚  â”‚ ðŸ“¦ 35ä¸ª â”‚ â”‚ âœ… 100% â”‚ â”‚ ðŸ“ˆ è¿è¡Œ â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€Uptime Kuma æœåŠ¡ç›‘æŽ§

### 4.1 Docker Compose

```yaml
# docker-compose.uptime.yml
version: '3.8'

services:
  uptime-kuma:
    image: louislam/uptime-kuma:latest
    container_name: uptime-kuma
    restart: always
    ports:
      - "3001:3001"
    volumes:
      - ./uptime-kuma/data:/app/data
    environment:
      - TZ=Asia/Shanghai
    networks:
      - proxy-net

networks:
  proxy-net:
    external: true
```

### 4.2 ç›‘æŽ§é…ç½®å»ºè®®

é¦–æ¬¡è®¿é—® `http://NAS-IP:3001` è®¾ç½®ç®¡ç†å‘˜è´¦å·åŽï¼Œæ·»åŠ ä»¥ä¸‹ç›‘æŽ§ï¼š

**HTTP(s) ç›‘æŽ§:**
```yaml
ç›‘æŽ§åˆ—è¡¨:
  - åç§°: GitLab
    ç±»åž‹: HTTP(s)
    URL: http://192.168.1.100:80
    å¿ƒè·³é—´éš”: 60ç§’

  - åç§°: Jenkins
    ç±»åž‹: HTTP(s)
    URL: http://192.168.1.100:8080
    å¿ƒè·³é—´éš”: 60ç§’

  - åç§°: Jellyfin
    ç±»åž‹: HTTP(s)
    URL: http://192.168.1.101:8096
    å¿ƒè·³é—´éš”: 60ç§’

  - åç§°: Home Assistant
    ç±»åž‹: HTTP(s)
    URL: http://192.168.1.101:8123
    å¿ƒè·³é—´éš”: 30ç§’  # æ™ºèƒ½å®¶å±…æ›´é¢‘ç¹æ£€æŸ¥
```

**TCP ç«¯å£ç›‘æŽ§:**
```yaml
  - åç§°: MySQL
    ç±»åž‹: TCP Port
    ä¸»æœº: 192.168.1.100
    ç«¯å£: 3306
    å¿ƒè·³é—´éš”: 60ç§’

  - åç§°: Redis
    ç±»åž‹: TCP Port
    ä¸»æœº: 192.168.1.100
    ç«¯å£: 6379
    å¿ƒè·³é—´éš”: 60ç§’

  - åç§°: DNSæœåŠ¡
    ç±»åž‹: TCP Port
    ä¸»æœº: 192.168.1.101
    ç«¯å£: 53
    å¿ƒè·³é—´éš”: 30ç§’
```

**Docker å®¹å™¨ç›‘æŽ§:**
```yaml
  - åç§°: GitLabå®¹å™¨
    ç±»åž‹: Docker Container
    å®¹å™¨å: gitlab
    Dockerä¸»æœº: tcp://192.168.1.100:2375

  - åç§°: Jellyfinå®¹å™¨
    ç±»åž‹: Docker Container
    å®¹å™¨å: jellyfin
    Dockerä¸»æœº: tcp://192.168.1.101:2375
```

### 4.3 é€šçŸ¥é…ç½®

```yaml
é€šçŸ¥æ¸ é“:
  - ç±»åž‹: Telegram
    Bot Token: your-bot-token
    Chat ID: your-chat-id

  - ç±»åž‹: é‚®ä»¶ (SMTP)
    SMTPæœåŠ¡å™¨: smtp.qq.com
    ç«¯å£: 465
    å‘ä»¶äºº: your@qq.com
    æ”¶ä»¶äºº: your@qq.com

  - ç±»åž‹: Webhook
    URL: https://your-webhook-url

  - ç±»åž‹: ä¼ä¸šå¾®ä¿¡
    Webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx
```

### 4.4 çŠ¶æ€é¡µé¢

Uptime Kuma æ”¯æŒåˆ›å»ºå…¬å¼€çŠ¶æ€é¡µï¼š

```
è®¾ç½® -> çŠ¶æ€é¡µé¢ -> æ–°å»º

åç§°: NASæœåŠ¡çŠ¶æ€
Slug: status (è®¿é—®è·¯å¾„: /status-page/status)
å…¬å¼€: æ˜¯

æ·»åŠ ç›‘æŽ§ç»„:
â”œâ”€â”€ å¼€å‘æœåŠ¡
â”‚   â”œâ”€â”€ GitLab
â”‚   â”œâ”€â”€ Jenkins
â”‚   â””â”€â”€ æ•°æ®åº“
â”œâ”€â”€ åª’ä½“æœåŠ¡
â”‚   â”œâ”€â”€ Jellyfin
â”‚   â”œâ”€â”€ Navidrome
â”‚   â””â”€â”€ Immich
â””â”€â”€ åŸºç¡€è®¾æ–½
    â”œâ”€â”€ DNS
    â”œâ”€â”€ åå‘ä»£ç†
    â””â”€â”€ NASä¸»æœº
```

---

## äº”ã€å¤‡é€‰å¯¼èˆªå·¥å…·

### 5.1 Dashy (åŠŸèƒ½æ›´ä¸°å¯Œ)

```yaml
# docker-compose.dashy.yml
version: '3.8'

services:
  dashy:
    image: lissy93/dashy:latest
    container_name: dashy
    restart: always
    ports:
      - "4000:80"
    volumes:
      - ./dashy/conf.yml:/app/public/conf.yml
    environment:
      - NODE_ENV=production
    networks:
      - proxy-net

networks:
  proxy-net:
    external: true
```

**conf.yml ç¤ºä¾‹:**
```yaml
pageInfo:
  title: NAS Dashboard
  description: æˆ‘çš„å®¶åº­æœåŠ¡å™¨

appConfig:
  theme: dark
  layout: auto
  iconSize: medium
  language: zh-CN
  statusCheck: true
  statusCheckInterval: 30

sections:
  - name: å¼€å‘å·¥å…·
    icon: fas fa-code
    items:
      - title: GitLab
        url: /gitlab/
        icon: fab fa-gitlab
        statusCheck: true
        statusCheckUrl: http://192.168.1.100:80

      - title: Jenkins
        url: /jenkins/
        icon: fab fa-jenkins
        statusCheck: true
        statusCheckUrl: http://192.168.1.100:8080

      - title: VS Code
        url: /code/
        icon: fas fa-laptop-code

  - name: åª’ä½“ä¸­å¿ƒ
    icon: fas fa-film
    items:
      - title: Jellyfin
        url: /media/
        icon: fas fa-play-circle
        statusCheck: true
        statusCheckUrl: http://192.168.1.101:8096

      - title: éŸ³ä¹
        url: /music/
        icon: fas fa-music
```

### 5.2 Homer (æžç®€)

```yaml
# docker-compose.homer.yml
version: '3.8'

services:
  homer:
    image: b4bz/homer:latest
    container_name: homer
    restart: always
    ports:
      - "8080:8080"
    volumes:
      - ./homer/assets:/www/assets
    environment:
      - TZ=Asia/Shanghai
    networks:
      - proxy-net
```

### 5.3 å·¥å…·å¯¹æ¯”

| ç‰¹æ€§ | Homepage | Dashy | Homer |
|------|----------|-------|-------|
| é…ç½®æ–¹å¼ | YAML | YAML/GUI | YAML |
| Dockeré›†æˆ | âœ… åŽŸç”Ÿ | âœ… | âŒ |
| æœåŠ¡çŠ¶æ€ | âœ… Widget | âœ… | âŒ |
| æœç´¢æ¡† | âœ… | âœ… | âœ… |
| ä¸»é¢˜ | å¤šä¸»é¢˜ | 100+ä¸»é¢˜ | å°‘é‡ |
| èµ„æºå ç”¨ | ä½Ž | ä¸­ | æžä½Ž |
| æŽ¨èåœºæ™¯ | åŠŸèƒ½å…¨é¢ | ä¸ªæ€§åŒ– | æžç®€ |

**æŽ¨è**: Homepage (åŠŸèƒ½ä¸Žæ˜“ç”¨æ€§å¹³è¡¡æœ€å¥½)

---

## å…­ã€cpolar é…ç½®

### 6.1 cpolar éš§é“é…ç½®

```yaml
# cpolaré…ç½® (é€šè¿‡Webé¢æ¿æˆ–é…ç½®æ–‡ä»¶)
tunnels:
  https:
    proto: https
    addr: "443"          # æœ¬åœ°NPMçš„HTTPSç«¯å£
    subdomain: mynas     # ä½ çš„å­åŸŸå

# æœ€ç»ˆè®¿é—®åœ°å€: https://mynas.cpolar.cn
```

### 6.2 NPM ä¸­é…ç½® cpolar åŸŸå

1. æ‰“å¼€ NPM ç®¡ç†ç•Œé¢ (`http://NAS-IP:81`)
2. Proxy Hosts -> Add Proxy Host
3. é…ç½®:
   - Domain: `mynas.cpolar.cn`
   - Forward Hostname: `homepage` (å¯¼èˆªé¡µå®¹å™¨å)
   - Forward Port: `3000`
   - å¼€å¯ "Block Common Exploits"
   - SSL: é€‰æ‹© "Request a new SSL Certificate" (Let's Encrypt)

### 6.3 å®Œæ•´è®¿é—®è·¯å¾„

```
å¤–ç½‘è®¿é—®:
https://mynas.cpolar.cn/           -> Homepageå¯¼èˆªé¡µ
https://mynas.cpolar.cn/gitlab/    -> GitLab
https://mynas.cpolar.cn/media/     -> Jellyfin
https://mynas.cpolar.cn/status/    -> Uptime Kuma

å†…ç½‘è®¿é—®:
http://192.168.1.101/              -> Homepage
http://192.168.1.100:80            -> GitLab (ç›´è¿ž)
http://192.168.1.101:8096          -> Jellyfin (ç›´è¿ž)
```

---

## ä¸ƒã€å®Œæ•´å¯åŠ¨å‘½ä»¤

```bash
#!/bin/bash
# start-proxy-stack.sh

# 1. åˆ›å»ºç½‘ç»œ
docker network create proxy-net 2>/dev/null || true

# 2. å¯åŠ¨ Nginx Proxy Manager
docker compose -f docker-compose.npm.yml up -d
echo "ç­‰å¾…NPMå¯åŠ¨..."
sleep 10

# 3. å¯åŠ¨å¯¼èˆªé¡µ
docker compose -f docker-compose.homepage.yml up -d

# 4. å¯åŠ¨æœåŠ¡ç›‘æŽ§
docker compose -f docker-compose.uptime.yml up -d

echo "ä»£ç†æ ˆå¯åŠ¨å®Œæˆ!"
echo ""
echo "è®¿é—®åœ°å€:"
echo "  NPMç®¡ç†:    http://NAS-IP:81"
echo "  å¯¼èˆªé¡µ:     http://NAS-IP:3000"
echo "  æœåŠ¡ç›‘æŽ§:   http://NAS-IP:3001"
```

---

## å…«ã€æœåŠ¡ Base URL é…ç½®æé†’

ä½¿ç”¨å­è·¯å¾„ä»£ç†æ—¶ï¼Œéƒ¨åˆ†æœåŠ¡éœ€è¦é…ç½® Base URLï¼š

| æœåŠ¡ | é…ç½®ä½ç½® | é…ç½®é¡¹ |
|------|----------|--------|
| GitLab | gitlab.rb | `external_url 'https://domain/gitlab'` |
| Jenkins | ç³»ç»Ÿç®¡ç† | Jenkins Location -> URL |
| Jupyter | å¯åŠ¨å‚æ•° | `--NotebookApp.base_url=/jupyter` |
| Grafana | grafana.ini | `root_url = /grafana/` |
| Nacos | application.properties | `server.servlet.contextPath=/nacos` |
| Home Assistant | configuration.yaml | è§ä¸‹æ–¹ |

**Home Assistant é…ç½®:**
```yaml
# configuration.yaml
http:
  use_x_forwarded_for: true
  trusted_proxies:
    - 192.168.1.0/24
```

**Jellyfin é…ç½®:**
```
æŽ§åˆ¶å° -> ç½‘ç»œ -> Base URL: /media
```
